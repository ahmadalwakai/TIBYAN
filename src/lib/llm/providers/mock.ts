/**
 * Mock LLM Provider
 * =================
 * Provides deterministic, safe responses for development/testing
 * when the local LLM server is unavailable.
 * 
 * NO EXTERNAL API KEYS REQUIRED.
 */

import type { LLMMessage, LLMCompletionResult, LLMProvider } from "../types";
import { detectIntent as detectUserIntent } from "../../ai-agent/intent";
import { UserIntent } from "../../ai-agent/types";

// ============================================
// Types
// ============================================

export interface MockResponse {
  provider: "mock";
  message: string;
  limitations: string;
  nextSteps: string[];
}

export interface MockDamageAnalyzerResponse {
  provider: "mock";
  damageScore: null;
  notes: string;
  actions: string[];
}

// ============================================
// Mock Response Templates
// ============================================

const MOCK_RESPONSES: Record<string, { message: string }> = {
  default: {
    message: `ุฃููุงู ูุณููุงู! ุฃูุง ูุณุงุนุฏ ุชุจูุงู ุงูุชุนูููู. 

ุฃุณุชุทูุน ูุณุงุนุฏุชู ูู:
โข ููู ุงููุญุชูู ุงูุชุนูููู ูุงูุฏุฑูุณ
โข ุงูุฅุฌุงุจุฉ ุนูู ุฃุณุฆูุฉ ุงูุทูุงุจ
โข ุชูุฏูู ูุตุงุฆุญ ุฏุฑุงุณูุฉ
โข ุชุญููู ุงูุตูุฑ ููุฃุถุฑุงุฑ (ููุทูุงุจ ุงูููุชููู ุจุงูููุฏุณุฉ)

ููู ูููููู ูุณุงุนุฏุชู ุงููููุ ูุฑุฌู ุชูุถูุญ ุทูุจู ุฃูุซุฑ ูุฃูุฏู ูู ุฅุฌุงุจุฉ ุฃูุถู.`,
  },
  clarification: {
    message: `ุนุฐุฑุงูุ ูู ุฃููู ุทูุจู ุจูุถูุญ. ูู ููููู ุชูุถูุญ ูุง ุชุญุชุงุฌู ูู ุงููุณุงุนุฏุฉุ

ุฃุณุชุทูุน ูุณุงุนุฏุชู ูู:
โข ุดุฑุญ ุงูููุงููู ุงูุชุนููููุฉ ูุงูุฏุฑูุณ
โข ุฅุนุฏุงุฏ ุฎุทุท ุงููุฐุงูุฑุฉ ูุงูุฏุฑุงุณุฉ
โข ุงููุณุงุนุฏุฉ ูู ุญู ุงูุชูุงุฑูู ูุงูุงุฎุชุจุงุฑุงุช
โข ุชูุฎูุต ุงููุญุชูู ุงูุชุนูููู
โข ุชุญููู ุงูุฃุถุฑุงุฑ (ุฅุฐุง ูุงู ูุฏูู ุตูุฑ)

ูุง ุงูููุถูุน ุงูุฐู ุชูุฏ ุงููุณุงุนุฏุฉ ูููุ`,
  },
  education_general: {
    message: `ุจุงูุชุฃููุฏ! ุฃูุง ููุง ููุณุงุนุฏุชู ูู ุฏุฑุงุณุชู.

ููุญุตูู ุนูู ุฃูุถู ูุณุงุนุฏุฉ ููููุฉุ ูุฑุฌู ุชุญุฏูุฏ:
1. ุงููุงุฏุฉ ุฃู ุงูููุถูุน ุงููุญุฏุฏ
2. ูุณุชูุงู ุงูุฏุฑุงุณู (ุฃุณุงุณู/ูุชูุณุท/ุซุงููู/ุฌุงูุนู)
3. ููุน ุงููุณุงุนุฏุฉ ุงููุทููุจุฉ (ุดุฑุญ ููููู/ุญู ุชูุฑูู/ูุฑุงุฌุนุฉ)

ุนูู ุณุจูู ุงููุซุงู: "ุฃุญุชุงุฌ ุดุฑุญุงู ูููููู ุงูุฌุฐูุฑ ุงูุชุฑุจูุนูุฉ ูู ุงูุฑูุงุถูุงุช ููุตู ุงูุซุงูุซ ุงูุซุงููู"

ููู ูููููู ูุณุงุนุฏุชู ูู ุฏุฑุงุณุชู ุงููููุ`,
  },
  study_plan: {
    message: `๐ ุฎุทุฉ ูุฐุงูุฑุฉ ูุฎุตุตุฉ

ุจูุงุกู ุนูู ุทูุจูุ ุฅููู ุฎุทุฉ ูุฐุงูุฑุฉ ููุธูุฉ:

**ุงูุฃุณุจูุน ุงูุฃูู: ุงูุฃุณุงุณูุงุช**
โข ุงูููู 1-2: ูุฑุงุฌุนุฉ ุงูููุงููู ุงูุฃุณุงุณูุฉ
โข ุงูููู 3: ุญู ุชูุงุฑูู ุจุณูุทุฉ
โข ุงูููู 4: ููู ุงูุฃูุซูุฉ ุงูุนูููุฉ
โข ุงูููู 5: ูุฑุงุฌุนุฉ ูุชูุฎูุต
โข ุงูููู 6-7: ุฑุงุญุฉ ูุชูุฑุงุฑ

**ุงูุฃุณุจูุน ุงูุซุงูู: ุงูุชุทุจูู**
โข ุญู ุงููุฒูุฏ ูู ุงูุชูุงุฑูู ุงููุนูุฏุฉ
โข ุฑุจุท ุงูููุงููู ุจุจุนุถูุง
โข ุชุทุจูู ูู ูุดุงูู ุงูุญูุงุฉ ุงูููููุฉ

**ูุตุงุฆุญ ูููุฉ:**
โข ุฎุตุต ููุชุงู ููููุงู ููุชุธูุงู
โข ุงุจุฏุฃ ุจุงูุฃุฌุฒุงุก ุงูุตุนุจุฉ ุนูุฏูุง ุชููู ูุดูุทุงู
โข ุงุณุชุฎุฏู ุทุฑู ูุฎุชููุฉ ูููุฑุงุฌุนุฉ (ูุชุงุจุฉุ ุฑุณูุ ุดุฑุญ ููุขุฎุฑูู)
โข ุงุฎุชุจุฑ ููุณู ุจุงูุชุธุงู

ูุฐู ุฎุทุฉ ุนุงูุฉ. ูููููู ุชุฎุตูุตูุง ุฃูุซุฑ ุฅุฐุง ุญุฏุฏุช ุงููุงุฏุฉ ูุงูููุช ุงููุชุงุญ ูุงููุณุชูู ุงูุญุงูู.`,
  },
  quiz_help: {
    message: `โ๏ธ ูุณุงุนุฏุฉ ูู ุงูุงุฎุชุจุงุฑุงุช ูุงูุชูุงุฑูู

ุฃุณุชุทูุน ูุณุงุนุฏุชู ูู:
โข ุดุฑุญ ููููุฉ ุญู ุฃููุงุน ูุฎุชููุฉ ูู ุงูุฃุณุฆูุฉ
โข ุชูุฏูู ุฃูุซูุฉ ูุดุงุจูุฉ ููุง ุณุชุฏุฑุณู
โข ูุตุงุฆุญ ููุฏุฑุงุณุฉ ุงููุนุงูุฉ ูุจู ุงูุงุฎุชุจุงุฑ
โข ุทุฑู ุชูุธูู ุงูููุช ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ

**ุฎุทูุงุช ุญู ุงููุณุงุฆู:**
1. ุงูุฑุฃ ุงูุณุคุงู ุจุนูุงูุฉ ูุญุฏุฏ ูุง ูุทูุจู
2. ุญุฏุฏ ุงููุนูููุงุช ุงููุชุงุญุฉ ูุงููุทููุจุฉ
3. ุงุฎุชุฑ ุงูุทุฑููุฉ ุงูููุงุณุจุฉ ููุญู
4. ููุฐ ุงูุญู ุฎุทูุฉ ุจุฎุทูุฉ
5. ุชุญูู ูู ุงูุฅุฌุงุจุฉ

ูุฑุฌู ูุดุงุฑูุฉ ุงูุณุคุงู ุงููุญุฏุฏ ุฃู ููุน ุงูุชูุฑูู ุงูุฐู ุชุญุชุงุฌ ูุณุงุนุฏุฉ ููู.`,
  },
  course_summary: {
    message: `๐ ููุฎุต ุงูุฏุฑุณ

**ุงูููุงุท ุงูุฑุฆูุณูุฉ:**
โข ุงููุญุชูู ุงูุฃุณุงุณู ููุฏุฑุณ
โข ุงูููุงููู ุงููููุฉ ุงููุทุฑูุญุฉ
โข ุงูุฃูุซูุฉ ุงูุนูููุฉ ุงููุณุชุฎุฏูุฉ

**ุงูุฃูุฏุงู ุงูุชุนููููุฉ:**
โข ููู ุงูููุงููู ุงูุฃุณุงุณูุฉ
โข ุชุทุจูู ุงููุนุฑูุฉ ูู ุญู ุงููุณุงุฆู
โข ุชุทููุฑ ุงูููุงุฑุงุช ุงูุนูููุฉ

**ูุตุงุฆุญ ูููุฑุงุฌุนุฉ:**
โข ุฑูุฒ ุนูู ุงูููุงููู ุงูุฃุณุงุณูุฉ ุฃููุงู
โข ุญู ุชูุงุฑูู ุฅุถุงููุฉ ููุชุฏุฑูุจ
โข ููุงูุดุฉ ุงูููุงุถูุน ูุน ุงูุฒููุงุก

ููุญุตูู ุนูู ููุฎุต ููุตู ุฃูุซุฑุ ูุฑุฌู ุชูุฏูู ูุญุชูู ุงูุฏุฑุณ ุฃู ูุตู ุงูููุถูุน ุงููุทููุจ.`,
  },
  damage_analysis: {
    message: `๐ง ุชุญููู ุงูุฃุถุฑุงุฑ

ููุญุตูู ุนูู ุชุญููู ุฏููู ููุฃุถุฑุงุฑุ ูุฑุฌู ุงูุชุฃูุฏ ูู:

๐ธ **ุงูุตูุฑ ุงููุทููุจุฉ:**
โข ุตูุฑุฉ ุนุงูุฉ ููุณูุงุฑุฉ ูู ุฌููุน ุงูุฌูุงุช ุงูุฃุฑุจุน
โข ุตูุฑ ููุฑุจุฉ ูููุงุทู ุงูุถุฑุฑ ุงููุดุชุจู ุจูุง  
โข ุตูุฑ ููุฏุงุฎู ุฅุฐุง ูุงู ููุงู ุถุฑุฑ ุฏุงุฎูู

๐ **ูุงุฆูุฉ ูุญุต ุงูุฃุถุฑุงุฑ ุงูุดุงุฆุนุฉ:**
โข ุฎุฏูุด ุฃู ุฎุดููุฉ ุนูู ุงูุทูุงุก
โข ุงูุจุนุงุฌุงุช ุฃู ุชุดููุงุช ูู ุงููููู
โข ูุณูุฑ ูู ุงูุฒุฌุงุฌ ุฃู ุงููุฑุงูุง
โข ุชูู ูู ุงูุฅุทุงุฑุงุช ุฃู ุงูุนุฌูุงุช
โข ุฃุถุฑุงุฑ ูู ุงูุฃุฌุฒุงุก ุงูุฏุงุฎููุฉ

๐ **ุงููุฆุงุช ุงููุญุชููุฉ ููุถุฑุฑ:**
โข ุฎุฏูุด ุณุทุญูุฉ (ุฃูู ูู 1 ูู ุนูู)
โข ุงูุจุนุงุฌุงุช ูุชูุณุทุฉ (1-5 ูู)  
โข ูุณูุฑ ุนูููุฉ (ุฃูุซุฑ ูู 5 ูู)
โข ุชูู ููููู ูุจูุฑ

๐ **ุงูุชูููู ูุงูุฅุตูุงุญ:**
โข ุชูุฏูุฑ ุงูุชูููุฉ ููุฅุตูุงุญ
โข ุฃููููุฉ ุงูุฅุตูุงุญุงุช ุงููุทููุจุฉ
โข ูุตุงุฆุญ ููููุงูุฉ ูู ุฃุถุฑุงุฑ ููุงุซูุฉ

ูุฑุฌู ุชูุฏูู ุงููุฒูุฏ ูู ุงูุชูุงุตูู ุฃู ุงูุตูุฑ ูุฅุฑุดุงุฏุงุช ุฃูุซุฑ ุฏูุฉ.`,
  },
  flashcards: {
    message: `๐๏ธ ุจุทุงูุงุช ุงููุฑุงุฌุนุฉ

ุฅููู ูููุฐุฌ ูุจุทุงูุงุช ูุฑุงุฌุนุฉ ุชูุงุนููุฉ:

**๐น ุงูุจุทุงูุฉ ุงูุฃููู:**
ุงูุณุคุงู: ูุง ูู ุงููุนุงุฏูุฉ ุงูุฃุณุงุณูุฉ ููุทุงูุฉุ
ุงูุฌูุงุจ: E = mcยฒ

**๐น ุงูุจุทุงูุฉ ุงูุซุงููุฉ:**  
ุงูุณุคุงู: ูู ูุฎุชุฑุน ุงููุตุจุงุญ ุงูููุฑุจุงุฆูุ
ุงูุฌูุงุจ: ุชููุงุณ ุฃุฏูุณูู

**๐น ุงูุจุทุงูุฉ ุงูุซุงูุซุฉ:**
ุงูุณุคุงู: ูุง ูู ุนุฏุฏ ููุงูุจ ุงููุธุงู ุงูุดูุณูุ
ุงูุฌูุงุจ: ุซูุงููุฉ ููุงูุจ

**๐ก ูุตุงุฆุญ ููุงุณุชุฐูุงุฑ:**
โข ุฑุงุฌุน ุงูุจุทุงูุงุช ููููุงู ููุฏุฉ 15 ุฏูููุฉ
โข ุงุจุฏุฃ ุจุงูุจุทุงูุงุช ุงูุฃุตุนุจ
โข ุงุณุชุฎุฏู ุงูุชูุฑุงุฑ ุงููุชุจุงุนุฏ
โข ุงูุชุจ ุฅุฌุงุจุชู ูุจู ููุจ ุงูุจุทุงูุฉ

ุญุฏุฏ ุงููุงุฏุฉ ูุงูููุถูุน ูุฃูุดุฆ ุจุทุงูุงุช ูุฎุตุตุฉ ูู!`,
  },
  exam_revision: {
    message: `๐ ูุฑุงุฌุนุฉ ุงูุงูุชุญุงู

**๐ ุฎุทุฉ ุงููุฑุงุฌุนุฉ ุงููุนุงูุฉ:**

**ุงูุฃุณุจูุน ุงูุฃุฎูุฑ ูุจู ุงูุงูุชุญุงู:**
โข ุงูููู 1-2: ูุฑุงุฌุนุฉ ุดุงููุฉ ูููุงุฏุฉ
โข ุงูููู 3-4: ุญู ุงูุชุญุงูุงุช ุงูุณููุงุช ุงูุณุงุจูุฉ  
โข ุงูููู 5: ูุฑุงุฌุนุฉ ุงูููุงุท ุงูุตุนุจุฉ
โข ุงูููู 6: ุฑุงุญุฉ ููุฑุงุฌุนุฉ ุฎูููุฉ
โข ุงูููู 7: ุงูุงูุชุญุงู

**๐ฏ ุชูููุงุช ุงููุฑุงุฌุนุฉ:**
โข ุงูุฎุฑุงุฆุท ุงูุฐูููุฉ ููููุงููู ุงูุฑุฆูุณูุฉ
โข ุชูุฎูุต ุงูุฏุฑูุณ ูู ููุงุท ูููุฉ
โข ุญู ุชูุงุฑูู ูุชููุนุฉ
โข ุดุฑุญ ุงูููุงุถูุน ูุดุฎุต ุขุฎุฑ

**โฐ ุฅุฏุงุฑุฉ ุงูููุช ูู ุงูุงูุชุญุงู:**
โข ุงูุฑุฃ ุฌููุน ุงูุฃุณุฆูุฉ ุฃููุงู
โข ุงุจุฏุฃ ุจุงูุฃุณุฆูุฉ ุงูุณููุฉ  
โข ุฎุตุต ููุช ููุงุณุจ ููู ุณุคุงู
โข ุฑุงุฌุน ุฅุฌุงุจุงุชู ูู ุงูููุงูุฉ

**๐ง ูุตุงุฆุญ ููุชูุชุฑ:**
โข ุชููุณ ุจุนูู ูุงุณุชุฑุฎู
โข ูู ุฌูุฏุงู ูุจู ุงูุงูุชุญุงู
โข ุชูุงูู ุฅูุทุงุฑ ุตุญู
โข ุชูุตู ูุจูุฑุงู ููุงุนุฉ ุงูุงูุชุญุงู

ูุง ุงููุงุฏุฉ ุงูุชู ุชุฑูุฏ ูุฑุงุฌุนุชูุงุ`,
  },
  step_by_step_tutor: {
    message: `๐จโ๐ซ ุงูุดุฑุญ ุฎุทูุฉ ุจุฎุทูุฉ

**๐ ูููุฌูุฉ ุงูุชุนูู ุงูุชุฏุฑูุฌู:**

**ุงูุฎุทูุฉ ุงูุฃููู: ููู ุงูุฃุณุงุณูุงุช**
โข ุชุนุฑู ุนูู ุงูููุงููู ุงูุฃุณุงุณูุฉ
โข ุงุฑุจุท ุงููุนูููุงุช ุงูุฌุฏูุฏุฉ ุจูุง ุชุนุฑูู
โข ุงุณุชุฎุฏู ุฃูุซูุฉ ูู ุงูุญูุงุฉ ุงูููููุฉ

**ุงูุฎุทูุฉ ุงูุซุงููุฉ: ุงูุชุทุจูู ุงูุจุณูุท**
โข ุงุจุฏุฃ ุจุชูุงุฑูู ุณููุฉ
โข ุทุจู ุงูููููู ุนูู ูุดุงูู ุจุณูุทุฉ  
โข ุชุฃูุฏ ูู ููู ูู ุฎุทูุฉ

**ุงูุฎุทูุฉ ุงูุซุงูุซุฉ: ุงูุชุนูู**
โข ุงูุชูู ููุณุงุฆู ุฃูุซุฑ ุชุนููุฏุงู
โข ุญูู ุงูุฃุฎุทุงุก ูุชุนูู ูููุง
โข ุฑุจุท ุงูููุงุถูุน ุจุจุนุถูุง ุงูุจุนุถ

**ุงูุฎุทูุฉ ุงูุฑุงุจุนุฉ: ุงูููุงุฑุณุฉ**
โข ุญู ุชูุงุฑูู ูุชููุนุฉ ููุชุฏุฑุฌุฉ
โข ุงุฎุชุจุฑ ููุณู ุจุงูุชุธุงู
โข ุฑุงุฌุน ุงูููุงููู ุฏูุฑูุงู

**๐ก ูุตูุญุฉ ูููุฉ:**
"ุงูุชุนูู ุฑุญูุฉุ ููุณ ุณุจุงู. ุฎุฐ ููุชู ูุชุฃูุฏ ูู ููู ูู ุฎุทูุฉ ูุจู ุงูุงูุชูุงู ููุชุงููุฉ."

ูุง ุงูููุถูุน ุงูุฐู ุชุฑูุฏ ุชุนููู ุฎุทูุฉ ุจุฎุทูุฉุ`,
  },
  project_troubleshooter: {
    message: `๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุญููุง

**๐๏ธ ูููุฌูุฉ ุญู ุงููุดุงูู:**

**1. ุชุญุฏูุฏ ุงููุดููุฉ:**
โข ูุง ูู ุงูุฎุทุฃ ุงูุฐู ูุธูุฑุ
โข ูุชู ุจุฏุฃุช ุงููุดููุฉุ  
โข ูุง ุงูุฐู ุชู ุชุบููุฑู ูุคุฎุฑุงูุ

**2. ุฌูุน ุงููุนูููุงุช:**
โข ุฑุณุงุฆู ุงูุฎุทุฃ ุงููุงููุฉ
โข ุจูุฆุฉ ุงูุชุทููุฑ ุงููุณุชุฎุฏูุฉ
โข ุงูุฎุทูุงุช ููุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงููุดููุฉ

**3. ุงูุชุดุฎูุต:**
โข ูุญุต ุงูุณุฌูุงุช (logs)
โข ุงูุชุญูู ูู ุงูุชุจุนูุงุช (dependencies)
โข ูุฑุงุฌุนุฉ ุงูุชูููู (configuration)

**4. ุงูุญููู ุงููุญุชููุฉ:**
โข ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ
โข ุชุญุฏูุซ ุงูุชุจุนูุงุช  
โข ูุฑุงุฌุนุฉ ุงูููุฏ ุงูุฃุฎูุฑ
โข ุงูุชุญูู ูู ุงูุฃุฐููุงุช

**๐จ ุงููุดุงูู ุงูุดุงุฆุนุฉ:**
โข ุฃุฎุทุงุก ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
โข ูุดุงูู ุงูุชุจุนูุงุช ุงูููููุฏุฉ
โข ุฃุฎุทุงุก ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
โข ูุดุงูู ุงูุฃุฐููุงุช ูุงููุตูู

ูุตู ูุดููุชู ุจุงูุชูุตูู ูุฃุณุงุนุฏู ูู ุญููุง!`,
  },
  code_review: {
    message: `๐ ูุฑุงุฌุนุฉ ุงูููุฏ - ูุงุฆูุฉ ูุฑุฌุนูุฉ

**โ ูุนุงููุฑ ุฌูุฏุฉ ุงูููุฏ:**

**๐ ุงูุจููุฉ ูุงูุชูุธูู:**
โข ูู ุงูููุฏ ููุธู ูููุฑูุกุ
โข ูู ุฃุณูุงุก ุงููุชุบูุฑุงุช ูุงูุฏูุงู ูุงุถุญุฉุ
โข ูู ูุชุจุน ุฃุณููุจ ูุชุงุจุฉ ููุญุฏุ
โข ูู ุงูุชุนูููุงุช ูุงููุฉ ููููุฏุฉุ

**๐ ุงูุฃูุงู:**
โข ูู ุชู ุงูุชุญูู ูู ุตุญุฉ ุงููุฏุฎูุงุชุ  
โข ูู ูุชู ุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญุ
โข ูู ูููุงุช ุงููุฑูุฑ ูุงูููุงุชูุญ ูุญููุฉุ
โข ูู ูุชู ุชุณุฌูู ุงูุฃุญุฏุงุซ ุงููููุฉุ

**โก ุงูุฃุฏุงุก:**
โข ูู ูุณุชุฎุฏู ุงูููุฏ ููุงุฑุฏ ุงููุธุงู ุจููุงุกุฉุ
โข ูู ุชูุฌุฏ ุงุณุชุนูุงูุงุช ููุงุนุฏ ุจูุงูุงุช ููุญุณูุฉุ
โข ูู ูุชู ุชุฌูุจ ุงูุชูุฑุงุฑ ุบูุฑ ุงูุถุฑูุฑูุ
โข ูู ุงูุชุฎุฒูู ุงููุคูุช (caching) ูุทุจู ุจุดูู ุตุญูุญุ

**๐งช ุงูุงุฎุชุจุงุฑ:**
โข ูู ุชูุฌุฏ ุงุฎุชุจุงุฑุงุช ูุงููุฉุ
โข ูู ุงูุงุฎุชุจุงุฑุงุช ุชุบุทู ุงูุญุงูุงุช ุงูุญุฏูุฉุ
โข ูู ูููู ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช ุจุณูููุฉุ

**๐ ุฃูุถู ุงูููุงุฑุณุงุช:**
โข ุงุชุจุงุน ูุจุงุฏุฆ SOLID
โข ุงุณุชุฎุฏุงู ุฃููุงุท ุงูุชุตููู ุงูููุงุณุจุฉ
โข ุชูุซูู ูุงุถุญ ููAPI
โข ุฅุฏุงุฑุฉ ูุนุงูุฉ ููุฃุฎุทุงุก

ุดุงุฑู ุงูููุฏ ููุฑุงุฌุนุฉ ููุตูุฉ!`,
  },
  lesson_summary: {
    message: `๐ ููุฎุต ุงูุฏุฑุณ

**ุงูููุงุท ุงูุฑุฆูุณูุฉ:**
โข ุงููุญุชูู ุงูุฃุณุงุณู ููุฏุฑุณ
โข ุงูููุงููู ุงููููุฉ ุงููุทุฑูุญุฉ
โข ุงูุฃูุซูุฉ ุงูุนูููุฉ ุงููุณุชุฎุฏูุฉ

**ุงูุฃูุฏุงู ุงูุชุนููููุฉ:**
โข ููู ุงูููุงููู ุงูุฃุณุงุณูุฉ
โข ุชุทุจูู ุงููุนุฑูุฉ ูู ุญู ุงููุณุงุฆู
โข ุชุทููุฑ ุงูููุงุฑุงุช ุงูุนูููุฉ

**ูุตุงุฆุญ ูููุฑุงุฌุนุฉ:**
โข ุฑูุฒ ุนูู ุงูููุงููู ุงูุฃุณุงุณูุฉ ุฃููุงู
โข ุญู ุชูุงุฑูู ุฅุถุงููุฉ ููุชุฏุฑูุจ
โข ููุงูุดุฉ ุงูููุงุถูุน ูุน ุงูุฒููุงุก

ููุญุตูู ุนูู ููุฎุต ููุตู ุฃูุซุฑุ ูุฑุฌู ุชูุฏูู ูุญุชูู ุงูุฏุฑุณ ุฃู ูุตู ุงูููุถูุน ุงููุทููุจ.`,
  },
};

// ============================================
// Intent Detection (Using AI Agent Intent System)
// ============================================

function detectIntent(message: string): string {
  const result = detectUserIntent(message, false); // No images in text-only chat

  // If the core intent system explicitly routes to DAMAGE_ANALYZER,
  // always use the dedicated damage analysis template.
  if (result.intent === UserIntent.DAMAGE_ANALYZER) {
    return "damage_analysis";
  }

  // In MOCK mode we still want to provide safe, educational damage guidance
  // even when the DAMAGE_ANALYZER feature flag is disabled. To achieve this
  // without weakening production gating, we independently detect clear
  // damage-related phrases here and map them to the damage template while
  // leaving the core intent classifier unchanged.
  const normalized = message.toLowerCase();
  const hasDamageSignal =
    /ุณูุงุฑ[ุช]ู|ุณูุงุฑู|ุฎุฏุด|ุงูุจุนุงุฌ|ุถุฑุฑ|ุชุตุงุฏู|ุญุงุฏุซ/.test(normalized);

  if (hasDamageSignal) {
    return "damage_analysis";
  }

  // Map UserIntent enum to response keys for all other intents
  switch (result.intent) {
    case UserIntent.EDUCATION_GENERAL:
      return "education_general";
    case UserIntent.STUDY_PLAN:
      return "study_plan";
    case UserIntent.QUIZ_HELP:
      return "quiz_help";
    case UserIntent.COURSE_SUMMARY:
      return "course_summary";
    case UserIntent.FLASHCARDS:
      return "flashcards";
    case UserIntent.EXAM_REVISION:
      return "exam_revision";
    case UserIntent.STEP_BY_STEP_TUTOR:
      return "step_by_step_tutor";
    case UserIntent.PROJECT_TROUBLESHOOTER:
      return "project_troubleshooter";
    case UserIntent.CODE_REVIEW:
      return "code_review";
    case UserIntent.UNKNOWN:
    default:
      return "clarification";
  }
}

// ============================================
// Mock Provider Implementation
// ============================================

export class MockLLMProvider implements LLMProvider {
  readonly name = "mock" as const;
  readonly isAvailable = true;

  /**
   * Generate a mock chat completion
   */
  async chatCompletion(
    messages: LLMMessage[],
    _options?: { temperature?: number; maxTokens?: number }
  ): Promise<LLMCompletionResult> {
    const startTime = Date.now();
    
    // Get the last user message
    const lastUserMessage = [...messages]
      .reverse()
      .find(m => m.role === "user");
    
    const userContent = lastUserMessage?.content || "";
    const intent = detectIntent(userContent);
    const mockResponse = MOCK_RESPONSES[intent] || MOCK_RESPONSES.default;

    const durationMs = Date.now() - startTime;

    console.log(`[Mock LLM] Generated response for intent: ${intent} (${durationMs}ms)`);

    return {
      ok: true,
      provider: "mock",
      content: mockResponse.message,
      usage: {
        promptTokens: userContent.length,
        completionTokens: mockResponse.message.length,
        totalTokens: userContent.length + mockResponse.message.length,
      },
      durationMs,
      cached: false,
    };
  }

  /**
   * Generate mock damage analyzer response
   */
  async analyzeDamage(
    _images: Array<{ base64?: string; url?: string }>,
    _context?: string
  ): Promise<MockDamageAnalyzerResponse> {
    console.log("[Mock LLM] Damage analyzer called in mock mode");
    
    return {
      provider: "mock",
      damageScore: null,
      notes: `ุชุญููู ุงูุฃุถุฑุงุฑ - ูุชุงุฆุฌ ูุจุฏุฆูุฉ:

ููุญุตูู ุนูู ุชุญููู ุฏููู ููุฃุถุฑุงุฑุ ูุฑุฌู ุงูุชุฃูุฏ ูู:

๐ธ ุงูุตูุฑ ุงููุทููุจุฉ:
โข ุตูุฑุฉ ุนุงูุฉ ููุณูุงุฑุฉ ูู ุฌููุน ุงูุฌูุงุช ุงูุฃุฑุจุน
โข ุตูุฑ ููุฑุจุฉ ูููุงุทู ุงูุถุฑุฑ ุงููุดุชุจู ุจูุง
โข ุตูุฑ ููุฏุงุฎู ุฅุฐุง ูุงู ููุงู ุถุฑุฑ ุฏุงุฎูู

๐ ูุงุฆูุฉ ูุญุต ุงูุฃุถุฑุงุฑ ุงูุดุงุฆุนุฉ:
โข ุฎุฏูุด ุฃู ุฎุดููุฉ ุนูู ุงูุทูุงุก
โข ุงูุจุนุงุฌุงุช ุฃู ุชุดููุงุช ูู ุงููููู
โข ูุณูุฑ ูู ุงูุฒุฌุงุฌ ุฃู ุงููุฑุงูุง
โข ุชูู ูู ุงูุฅุทุงุฑุงุช ุฃู ุงูุนุฌูุงุช
โข ุฃุถุฑุงุฑ ูู ุงูุฃุฌุฒุงุก ุงูุฏุงุฎููุฉ

๐ ุงููุฆุงุช ุงููุญุชููุฉ ููุถุฑุฑ:
โข ุฎุฏูุด ุณุทุญูุฉ (ุฃูู ูู 1 ูู ุนูู)
โข ุงูุจุนุงุฌุงุช ูุชูุณุทุฉ (1-5 ูู)
โข ูุณูุฑ ุนูููุฉ (ุฃูุซุฑ ูู 5 ูู)
โข ุชูู ููููู ูุจูุฑ

ูุฑุฌู ุชูุฏูู ุงููุฒูุฏ ูู ุงูุชูุงุตูู ุฃู ุงูุตูุฑ ูุชุญููู ุฃูุซุฑ ุฏูุฉ.`,
      actions: [
        "ุงูุชูุท ุตูุฑุงู ุฅุถุงููุฉ ูู ุฒูุงูุง ูุฎุชููุฉ",
        "ููุณ ุฃุจุนุงุฏ ุงูุถุฑุฑ ุฅู ุฃููู",
        "ุญุฏุฏ ููุน ุงููุฑูุจุฉ ูุงูููุฏูู",
        "ูุตู ุงูุธุฑูู ุงูุชู ุญุฏุซ ูููุง ุงูุถุฑุฑ",
      ],
    };
  }

  /**
   * Generate mock lesson summary
   */
  async summarizeLesson(_content: string): Promise<LLMCompletionResult> {
    return {
      ok: true,
      provider: "mock",
      content: `๐ ููุฎุต ุงูุฏุฑุณ

**ุงูููุงุท ุงูุฑุฆูุณูุฉ:**
โข ุงููุญุชูู ุงูุฃุณุงุณู ููุฏุฑุณ
โข ุงูููุงููู ุงููููุฉ ุงููุทุฑูุญุฉ
โข ุงูุฃูุซูุฉ ุงูุนูููุฉ ุงููุณุชุฎุฏูุฉ

**ุงูุฃูุฏุงู ุงูุชุนููููุฉ:**
โข ููู ุงูููุงููู ุงูุฃุณุงุณูุฉ
โข ุชุทุจูู ุงููุนุฑูุฉ ูู ุญู ุงููุณุงุฆู
โข ุชุทููุฑ ุงูููุงุฑุงุช ุงูุนูููุฉ

**ูุตุงุฆุญ ูููุฑุงุฌุนุฉ:**
โข ุฑูุฒ ุนูู ุงูููุงููู ุงูุฃุณุงุณูุฉ ุฃููุงู
โข ุญู ุชูุงุฑูู ุฅุถุงููุฉ ููุชุฏุฑูุจ
โข ููุงูุดุฉ ุงูููุงุถูุน ูุน ุงูุฒููุงุก

ููุญุตูู ุนูู ููุฎุต ููุตู ุฃูุซุฑุ ูุฑุฌู ุชูุฏูู ูุญุชูู ุงูุฏุฑุณ ุฃู ูุตู ุงูููุถูุน ุงููุทููุจ.`,
      usage: { promptTokens: 100, completionTokens: 200, totalTokens: 300 },
      durationMs: 1,
      cached: false,
    };
  }

  /**
   * Generate mock quiz
   */
  async generateQuiz(_content: string, _count: number): Promise<LLMCompletionResult> {
    return {
      ok: true,
      provider: "mock",
      content: JSON.stringify({
        questions: [
          {
            id: "q1",
            type: "multiple_choice",
            question: "ูุง ูู ุงูููููู ุงูุฃุณุงุณู ุงููุทุฑูุญ ูู ูุฐุง ุงูุฏุฑุณุ",
            options: ["ุงูุฎูุงุฑ ุงูุฃูู", "ุงูุฎูุงุฑ ุงูุซุงูู", "ุงูุฎูุงุฑ ุงูุซุงูุซ", "ุงูุฎูุงุฑ ุงูุฑุงุจุน"],
            correctAnswer: 0,
            explanation: "ูุฐุง ูู ุงูุดุฑุญ ููุฅุฌุงุจุฉ ุงูุตุญูุญุฉ"
          },
          {
            id: "q2",
            type: "true_false",
            question: "ูู ูุฐุง ุงูุจูุงู ุตุญูุญุ",
            correctAnswer: true,
            explanation: "ุงูุชูุณูุฑ ุงูููุตู ููุฅุฌุงุจุฉ"
          },
          {
            id: "q3",
            type: "short_answer",
            question: "ุงุดุฑุญ ุงูููููู ุจุงุฎุชุตุงุฑ",
            correctAnswer: "ุงูุฅุฌุงุจุฉ ุงููุซุงููุฉ",
            explanation: "ูุตุงุฆุญ ููุฅุฌุงุจุฉ ุนูู ูุฐุง ุงูุณุคุงู"
          }
        ],
        note: "ูุฐู ุฃุณุฆูุฉ ูููุฐุฌูุฉ. ููุญุตูู ุนูู ุงุฎุชุจุงุฑ ูุฎุตุตุ ูุฑุฌู ุชูุฏูู ูุญุชูู ุงูุฏุฑุณ ุฃู ุงูููุถูุน ุงููุทููุจ.",
      }),
      usage: { promptTokens: 150, completionTokens: 300, totalTokens: 450 },
      durationMs: 1,
      cached: false,
    };
  }
}

// ============================================
// Singleton Instance
// ============================================

export const mockProvider = new MockLLMProvider();
